<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Transkrip Tools - Popup Mode</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 15px;
        }

        .container {
            max-width: 500px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 20px;
            text-align: center;
        }

        .header h1 {
            font-size: 1.5rem;
            margin-bottom: 5px;
        }

        .content {
            padding: 20px;
        }

        .section {
            margin-bottom: 20px;
        }

        .section label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }

        .text-area {
            width: 100%;
            height: 130px;
            padding: 12px;
            border: 2px solid #e1e8ed;
            border-radius: 10px;
            font-size: 14px;
            resize: vertical;
            background: #f8fafc;
        }

        .controls {
            background: #f1f5f9;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
        }

        .control-group {
            margin-bottom: 15px;
        }

        .control-group:last-child {
            margin-bottom: 0;
        }

        .slider-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .slider {
            flex: 1;
            height: 25px;
        }

        .value-display {
            min-width: 40px;
            text-align: center;
            font-weight: 600;
            color: #4facfe;
        }

        .buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-bottom: 20px;
        }

        .btn {
            padding: 14px;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            text-align: center;
            transition: all 0.2s;
        }

        .btn:active {
            transform: scale(0.98);
        }

        .btn-primary { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); color: white; }
        .btn-secondary { background: #e2e8f0; color: #4a5568; }
        .btn-success { background: linear-gradient(135deg, #0fd850 0%, #00c9ff 100%); color: white; }
        .btn-danger { background: linear-gradient(135deg, #ff6b6b 0%, #ff8e53 100%); color: white; }
        .btn-warning { background: linear-gradient(135deg, #f6d365 0%, #fda085 100%); color: white; }

        .preview {
            height: 180px;
            border: 2px solid #e1e8ed;
            border-radius: 10px;
            padding: 15px;
            background: #f8fafc;
            overflow: hidden;
        }

        .preview-content {
            height: 100%;
            overflow-y: auto;
            font-size: 16px;
            line-height: 1.6;
        }

        .instructions {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
        }

        .instructions h3 {
            margin-bottom: 10px;
            color: #856404;
        }

        .instructions ul {
            padding-left: 20px;
        }

        .instructions li {
            margin-bottom: 8px;
            font-size: 14px;
        }

        .status {
            text-align: center;
            padding: 10px;
            background: #e2e8f0;
            border-radius: 8px;
            font-size: 14px;
            color: #4a5568;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Transkrip Tools</h1>
            <p>Popup Window untuk Rekaman Layar</p>
        </div>
        
        <div class="content">
            <div class="instructions">
                <h3>CARA MENGGUNAKAN (SANGAT PENTING):</h3>
                <ul>
                    <li><strong>Klik tombol "Buka Popup Mengambang"</strong></li>
                    <li><strong>Izinkan popup jika diminta browser</strong></li>
                    <li><strong><u>Jendela popup akan selalu di depan!</u></strong></li>
                    <li><strong>Gunakan saat merekam layar - popup tetap terlihat!</strong></li>
                    <li><strong>Atur posisi popup sesuai kebutuhan</strong></li>
                </ul>
            </div>

            <div class="section">
                <label for="textInput">Masukkan Transkrip:</label>
                <textarea class="text-area" id="textInput" placeholder="Tulis atau tempel transkrip Anda di sini...">SELAMAT DATANG DI TRANSKRIP TOOLS!

Ini adalah contoh teks panjang untuk menunjukkan fungsi popup mengambang. Anda dapat mengganti teks ini dengan transkrip video, presentasi, atau konten lainnya.

FITUR UTAMA:
â€¢ Teks akan bergulir secara otomatis
â€¢ Gunakan slider untuk mengatur kecepatan scrolling
â€¢ Popup window selalu di depan aplikasi lain
â€¢ Sangat berguna saat merekam video/presentasi
â€¢ Kontrol penuh dari jendela utama

CARA MENGGUNAKAN SAAT REKAM:
1. Klik "Buka Popup Mengambang"
2. Izinkan popup jika diminta
3. Atur posisi popup di layar
4. Mulai merekam layar
5. Popup akan tetap terlihat!

TIPS:
â€¢ Aktifkan popup SEBELUM merekam
â€¢ Drag popup ke posisi yang nyaman
â€¢ Gunakan kontrol dari jendela utama ini</textarea>
            </div>
            
            <div class="controls">
                <div class="control-group">
                    <label for="speedControl">Kecepatan Scroll</label>
                    <div class="slider-container">
                        <input type="range" min="1" max="20" value="5" class="slider" id="speedControl">
                        <span class="value-display" id="speedValue">5</span>
                    </div>
                </div>
                
                <div class="control-group">
                    <label for="fontSize">Ukuran Font</label>
                    <div class="slider-container">
                        <input type="range" min="12" max="24" value="16" class="slider" id="fontSize">
                        <span class="value-display" id="fontSizeValue">16px</span>
                    </div>
                </div>
            </div>
            
            <div class="buttons">
                <button class="btn btn-primary" id="startBtn">Mulai Scroll</button>
                <button class="btn btn-secondary" id="pauseBtn">Jeda</button>
                <button class="btn btn-danger" id="resetBtn">Reset</button>
                <button class="btn btn-success" id="saveBtn">Simpan</button>
            </div>
            
            <div class="buttons">
                <button class="btn btn-warning" id="popupBtn" style="grid-column: span 2;">ðŸš€ BUKA POPUP MENGAMBANG</button>
            </div>
            
            <div class="section">
                <label>Preview Transkrip:</label>
                <div class="preview">
                    <div class="preview-content" id="previewContent"></div>
                </div>
            </div>
            
            <div class="status" id="status">
                Status: Siap - Klik tombol popup untuk mode mengambang
            </div>
        </div>
    </div>

    <script>
        // Elemen-elemen
        const textInput = document.getElementById('textInput');
        const previewContent = document.getElementById('previewContent');
        const speedControl = document.getElementById('speedControl');
        const speedValue = document.getElementById('speedValue');
        const fontSize = document.getElementById('fontSize');
        const fontSizeValue = document.getElementById('fontSizeValue');
        const startBtn = document.getElementById('startBtn');
        const pauseBtn = document.getElementById('pauseBtn');
        const resetBtn = document.getElementById('resetBtn');
        const saveBtn = document.getElementById('saveBtn');
        const popupBtn = document.getElementById('popupBtn');
        const status = document.getElementById('status');

        // Variabel kontrol
        let scrollInterval;
        let isScrolling = false;
        let speed = 5;
        let fontSizeValueCurrent = 16;
        let popupWindow = null;

        // Inisialisasi
        function init() {
            updatePreview();
            previewContent.style.fontSize = fontSizeValueCurrent + 'px';
            
            // Event listeners
            setupEventListeners();
        }

        function setupEventListeners() {
            // Controls
            speedControl.addEventListener('input', function() {
                speed = parseInt(this.value);
                speedValue.textContent = speed;
                sendToPopup('UPDATE_SPEED', { speed: speed });
            });

            fontSize.addEventListener('input', function() {
                fontSizeValueCurrent = parseInt(this.value);
                fontSizeValue.textContent = fontSizeValueCurrent + 'px';
                previewContent.style.fontSize = fontSizeValueCurrent + 'px';
                sendToPopup('UPDATE_FONT_SIZE', { fontSize: fontSizeValueCurrent });
            });

            textInput.addEventListener('input', function() {
                updatePreview();
                sendToPopup('UPDATE_TEXT', { text: this.value });
            });

            // Buttons
            startBtn.addEventListener('click', function() {
                startScrolling();
                sendToPopup('START_SCROLL');
            });
            
            pauseBtn.addEventListener('click', function() {
                pauseScrolling();
                sendToPopup('PAUSE_SCROLL');
            });
            
            resetBtn.addEventListener('click', function() {
                resetScrolling();
                sendToPopup('RESET_SCROLL');
            });
            
            saveBtn.addEventListener('click', saveText);
            popupBtn.addEventListener('click', openPopupWindow);
        }

        function updatePreview() {
            const text = textInput.value || 'Masukkan teks transkrip Anda...';
            previewContent.innerHTML = text.replace(/\n/g, '<br>');
        }

        // Scrolling functions
        function startScrolling() {
            if (isScrolling) return;
            
            isScrolling = true;
            startBtn.disabled = true;
            status.textContent = 'Status: Scrolling aktif...';
            
            scrollInterval = setInterval(() => {
                previewContent.scrollTop += speed;
                sendToPopup('SCROLL_POSITION', { position: previewContent.scrollTop });
                
                // Reset jika sampai akhir
                if (previewContent.scrollTop >= previewContent.scrollHeight - previewContent.clientHeight) {
                    resetScrolling();
                }
            }, 100);
        }

        function pauseScrolling() {
            if (!isScrolling) return;
            
            clearInterval(scrollInterval);
            isScrolling = false;
            startBtn.disabled = false;
            status.textContent = 'Status: Scrolling dijeda';
        }

        function resetScrolling() {
            pauseScrolling();
            previewContent.scrollTop = 0;
            sendToPopup('SCROLL_POSITION', { position: 0 });
            status.textContent = 'Status: Reset posisi scroll';
            setTimeout(() => {
                status.textContent = 'Status: Siap';
            }, 2000);
        }

        // Save function
        function saveText() {
            const textToSave = textInput.value || ' ';
            const blob = new Blob([textToSave], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = 'transkrip.txt';
            document.body.appendChild(a);
            a.click();
            
            setTimeout(() => {
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            }, 100);
            
            status.textContent = 'Status: Teks disimpan!';
            setTimeout(() => {
                status.textContent = 'Status: Siap';
            }, 2000);
        }

        // Popup window functions
        function openPopupWindow() {
            // Buat HTML untuk popup
            const popupHTML = `
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Transkrip Mengambang</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }
        
        body {
            background: white;
            height: 100vh;
            display: flex;
            flex-direction: column;
            border: 3px solid #4facfe;
            border-radius: 10px;
            overflow: hidden;
        }
        
        .popup-header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 10px 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: 600;
            cursor: move;
            -webkit-user-select: none;
            user-select: none;
        }
        
        .popup-controls {
            display: flex;
            gap: 8px;
        }
        
        .popup-btn {
            background: rgba(255,255,255,0.2);
            border: none;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            color: white;
            cursor: pointer;
            font-weight: bold;
        }
        
        .popup-btn:hover {
            background: rgba(255,255,255,0.3);
        }
        
        .popup-content {
            flex: 1;
            padding: 15px;
            display: flex;
            flex-direction: column;
            background: #f8fafc;
        }
        
        .popup-controls-row {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 8px;
            margin-bottom: 15px;
        }
        
        .popup-control-btn {
            padding: 10px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            font-size: 12px;
        }
        
        .popup-start { background: #4facfe; color: white; }
        .popup-pause { background: #e2e8f0; color: #4a5568; }
        .popup-reset { background: #ff6b6b; color: white; }
        
        .popup-transcript {
            flex: 1;
            background: white;
            border: 2px solid #e1e8ed;
            border-radius: 8px;
            padding: 12px;
            overflow-y: auto;
            font-size: 16px;
            line-height: 1.6;
        }
        
        .popup-transcript::-webkit-scrollbar {
            width: 8px;
        }
        
        .popup-transcript::-webkit-scrollbar-track {
            background: #f1f5f9;
            border-radius: 4px;
        }
        
        .popup-transcript::-webkit-scrollbar-thumb {
            background: #cbd5e0;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <div class="popup-header" id="popupHeader">
        <span>Transkrip Mengambang</span>
        <div class="popup-controls">
            <button class="popup-btn" id="minimizeBtn" title="Minimalkan">âˆ’</button>
            <button class="popup-btn" id="closeBtn" title="Tutup">Ã—</button>
        </div>
    </div>
    
    <div class="popup-content">
        <div class="popup-controls-row">
            <button class="popup-control-btn popup-start" id="popupStartBtn">Mulai</button>
            <button class="popup-control-btn popup-pause" id="popupPauseBtn">Jeda</button>
            <button class="popup-control-btn popup-reset" id="popupResetBtn">Reset</button>
        </div>
        
        <div class="popup-transcript" id="popupTranscript">SELAMAT DATANG DI TRANSKRIP TOOLS!

Ini adalah contoh teks panjang untuk menunjukkan fungsi popup mengambang. Anda dapat mengganti teks ini dengan transkrip video, presentasi, atau konten lainnya.

FITUR UTAMA:
â€¢ Teks akan bergulir secara otomatis
â€¢ Gunakan slider untuk mengatur kecepatan scrolling
â€¢ Popup window selalu di depan aplikasi lain
â€¢ Sangat berguna saat merekam video/presentasi
â€¢ Kontrol penuh dari jendela utama ini

CARA MENGGUNAKAN SAAT REKAM:
1. Klik "Buka Popup Mengambang"
2. Izinkan popup jika diminta
3. Atur posisi popup di layar
4. Mulai merekam layar
5. Popup akan tetap terlihat!

TIPS:
â€¢ Aktifkan popup SEBELUM merekam
â€¢ Drag popup ke posisi yang nyaman
â€¢ Gunakan kontrol dari jendela utama ini</div>
    </div>

    <script>
        // Elemen popup
        const popupTranscript = document.getElementById('popupTranscript');
        const popupStartBtn = document.getElementById('popupStartBtn');
        const popupPauseBtn = document.getElementById('popupPauseBtn');
        const popupResetBtn = document.getElementById('popupResetBtn');
        const closeBtn = document.getElementById('closeBtn');
        const minimizeBtn = document.getElementById('minimizeBtn');
        const popupHeader = document.getElementById('popupHeader');
        
        // Variabel kontrol popup
        let isMinimized = false;
        let isDragging = false;
        let dragOffset = { x: 0, y: 0 };
        
        // Event listeners popup
        popupStartBtn.addEventListener('click', function() {
            window.opener.postMessage({type: 'START_SCROLL'}, '*');
        });
        
        popupPauseBtn.addEventListener('click', function() {
            window.opener.postMessage({type: 'PAUSE_SCROLL'}, '*');
        });
        
        popupResetBtn.addEventListener('click', function() {
            window.opener.postMessage({type: 'RESET_SCROLL'}, '*');
        });
        
        closeBtn.addEventListener('click', function() {
            window.close();
        });
        
        minimizeBtn.addEventListener('click', function() {
            if (isMinimized) {
                document.body.style.height = '300px';
                minimizeBtn.textContent = 'âˆ’';
                isMinimized = false;
            } else {
                document.body.style.height = '44px';
                minimizeBtn.textContent = '+';
                isMinimized = true;
            }
        });
        
        // Dragging
        popupHeader.addEventListener('mousedown', startDrag);
        document.addEventListener('mousemove', drag);
        document.addEventListener('mouseup', endDrag);
        
        function startDrag(e) {
            isDragging = true;
            dragOffset.x = e.clientX - window.screenX;
            dragOffset.y = e.clientY - window.screenY;
        }
        
        function drag(e) {
            if (!isDragging) return;
            window.moveTo(e.screenX - dragOffset.x, e.screenY - dragOffset.y);
        }
        
        function endDrag() {
            isDragging = false;
        }
        
        // Terima pesan dari parent
        window.addEventListener('message', function(event) {
            const data = event.data;
            
            switch(data.type) {
                case 'UPDATE_TEXT':
                    popupTranscript.innerHTML = data.text.replace(/\\n/g, '<br>');
                    break;
                case 'UPDATE_SPEED':
                    // Kecepatan diatur di parent
                    break;
                case 'UPDATE_FONT_SIZE':
                    popupTranscript.style.fontSize = data.fontSize + 'px';
                    break;
                case 'SCROLL_POSITION':
                    popupTranscript.scrollTop = data.position;
                    break;
                case 'START_SCROLL':
                    // Diatur di parent
                    break;
                case 'PAUSE_SCROLL':
                    // Diatur di parent
                    break;
                case 'RESET_SCROLL':
                    popupTranscript.scrollTop = 0;
                    break;
            }
        });
        
        // Kirim pesan bahwa popup siap
        window.onload = function() {
            window.opener.postMessage({type: 'POPUP_READY'}, '*');
        };
    <\/script>
</body>
</html>
            `;

            // Buka popup window
            const popupFeatures = `
                width=350,
                height=300,
                left=100,
                top=100,
                resizable=yes,
                scrollbars=no,
                status=no,
                toolbar=no,
                menubar=no,
                location=no
            `.replace(/\s/g, '');
            
            popupWindow = window.open('', 'TranskripMengambang', popupFeatures);
            
            if (popupWindow) {
                popupWindow.document.write(popupHTML);
                popupWindow.document.close();
                status.textContent = 'Status: Popup mengambang aktif! Geser ke posisi yang nyaman.';
                popupBtn.textContent = 'ðŸ”„ REFRESH POPUP';
            } else {
                alert('Popup diblokir! Izinkan popup di browser Anda:\n\n1. Klik ikon ðŸ”’ di address bar\n2. Pilih "Site settings"\n3. Izinkan "Popups and redirects"\n4. Refresh halaman ini\n5. Coba lagi');
                status.textContent = 'Status: Popup diblokir - ikuti instruksi di alert';
            }
        }

        // Kirim pesan ke popup
        function sendToPopup(type, data = {}) {
            if (popupWindow && !popupWindow.closed) {
                popupWindow.postMessage({ type, ...data }, '*');
            }
        }

        // Terima pesan dari popup
        window.addEventListener('message', function(event) {
            const data = event.data;
            
            switch(data.type) {
                case 'START_SCROLL':
                    startScrolling();
                    break;
                case 'PAUSE_SCROLL':
                    pauseScrolling();
                    break;
                case 'RESET_SCROLL':
                    resetScrolling();
                    break;
                case 'POPUP_READY':
                    status.textContent = 'Status: Popup siap! Sekarang Anda bisa merekam layar.';
                    break;
            }
        });

        // Initialize
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
